## 第2章 RabbitMQ入门

### 2.1 相关概念介绍

RabbitMQ模型架构：

![](https://ws1.sinaimg.cn/large/8747d788gy1fwt02cto5vj20hn08ajs3.jpg)

#### 2.1.1 生产者和消费者

Producer：生产者，投递消息的一方
发送的消息包括：消息体(payload)和标签(Lable)两部分。消息体：业务消息（例如JSON字符串）；标签：可理解为消息转发的机制（例如：一个交换机的名称和一个路由键）

Consumer：消费者，接收消息的一方
消费者订阅到的是队列。消费者消费的只是消息体，标签在路由的过程中被丢弃了，存到队列中的消息只有消息体。

Broker：消息中间件的服务节点

▲一个消费者的例子：消费者进程可以使用一个线程去接收消息，存到内存中，比如使用Java中的BlockingQueue。业务处理逻辑使用另一个线程从内存中读取，这样可以将应用进一步解耦，提高整个应用的处理效率。（问题，如果内存挂了咋整？）

#### 2.1.2 队列

Queue:队列，是RabbitMQ的内部对象，**用于存储消息**。

* RabbitMQ中的消息只能存在队列中（与Kafka不同）
* RabbitMQ的生产者消息最终投递到队列中，消费者从队列中获取消息并消费
* 多个消费者可订阅同一个队列，这时队列中的消息会被平摊（轮训）给各个消费者处理，不是各个消费者都收到消息并处理
* RabbitMQ不支持队列层面的广播消费。（如果需要广播消费，需要在其上进行二次开发，处理逻辑会变得异常复杂，不建议）

#### 2.1.3 交换器、路由键、绑定

#### 2.1.4 交换器类型 

#### 2.1.5 RabbitMQ运转流程

### 2.2 AMQP协议介绍

#### 2.1.1 AMQP生产者流转过程

#### 2.1.2 AMQP消费者流转过程

#### 2.1.3 AMQP命令概览